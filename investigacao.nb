(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    177386,       4908]
NotebookOptionsPosition[    170998,       4809]
NotebookOutlinePosition[    171435,       4826]
CellTagsIndexPosition[    171392,       4823]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"sigmax", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Za", "=", 
   RowBox[{"Tr", "[", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "ba"}], "*", "ea", "*", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "3", "]"}], "/", "2"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zb", "=", 
   RowBox[{"Tr", "[", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "bb"}], "*", "eb", "*", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "3", "]"}], "/", "2"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "ea"}], "*", "ba"}], "-", 
        RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "ea"}], "*", "ba"}], "+", 
        RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ea", "*", "ba"}], "-", 
        RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ea", "*", "ba"}], "+", 
        RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9542416704900208`*^9, 3.954241670490724*^9}, {
  3.954242014429866*^9, 3.954242036915023*^9}, {3.954242112163776*^9, 
  3.954242125949383*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"33e77633-8c40-4fbd-8ff3-e06837bafe22"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhox", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", "0", ",", "z"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "b", ",", "w", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "w", ",", "c", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", "0", ",", "d"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ux", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "x"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "x", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "x"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "x", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sqrt", "[", "x", "]"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "x"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sqrt", "[", "x", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "x"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoxf", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Ux", ".", "rhox", ".", 
      RowBox[{"ConjugateTranspose", "[", "Ux", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", ">=", "0"}], " ", "&&", 
       RowBox[{"1", ">=", "x"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hab", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ea"}], "*", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], "/", "2"}]}], "-", 
    RowBox[{"eb", "*", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Wx", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"Hab", ".", 
     RowBox[{"(", 
      RowBox[{"rhox", "-", "rhoxf"}], ")"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9549210112261066`*^9, 3.954921026481378*^9}, {
  3.954922362715975*^9, 3.954922391727623*^9}, {3.954929934017351*^9, 
  3.954929935432563*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"bc73fb15-897c-4942-8634-0de2cc06af16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   SqrtBox[
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ea", "-", "eb"}], ")"}], " ", "w"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ea", "+", "eb"}], ")"}], " ", "z"}]}], ")"}]}], "+", 
  RowBox[{"ea", " ", "x", " ", 
   RowBox[{"Tanh", "[", 
    FractionBox[
     RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "+", 
  RowBox[{"eb", " ", "x", " ", 
   RowBox[{"Tanh", "[", 
    FractionBox[
     RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.954241856103126*^9, 3.954242131646139*^9, 3.954920508969343*^9, {
   3.954920979741706*^9, 3.95492102837661*^9}, 3.954922311438286*^9, {
   3.954922373258717*^9, 3.954922395452807*^9}, 3.956142408179593*^9, 
   3.95614819417837*^9, 3.9567371726532793`*^9, 3.956924512358378*^9, 
   3.9572588410056067`*^9, 3.9573421624376183`*^9, 3.957342330539176*^9, 
   3.957346687642383*^9, 3.957360604647275*^9, 3.957612159164036*^9, 
   3.9592617834043093`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"5b4dbbb2-5c7b-41c7-a707-372f1bb5d4ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rhox", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Ux", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9549227176647243`*^9, 3.954922726349905*^9}, {
  3.954929938458788*^9, 3.954929952406447*^9}, {3.954932286947022*^9, 
  3.954932289989595*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8c0a3435-cb5e-4149-9e79-da074c18cd9b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0", "0", "z"},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"bb", " ", "eb"}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "w", "0"},
     {"0", "w", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"ba", " ", "ea"}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0"},
     {"z", "0", "0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"ba", " ", "ea"}], "+", 
         RowBox[{"bb", " ", "eb"}]}]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9549210412505207`*^9, 3.954922727357733*^9, 
  3.954929954584083*^9, 3.954932290708418*^9, 3.957342334367898*^9, 
  3.957346688095044*^9, 3.9573606059945*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"5750a5ff-7750-457d-bc44-\
1b716c12206e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SqrtBox[
       RowBox[{"1", "-", "x"}]], "0", "0", 
      RowBox[{"-", 
       SqrtBox["x"]}]},
     {"0", 
      SqrtBox[
       RowBox[{"1", "-", "x"}]], 
      RowBox[{"-", 
       SqrtBox["x"]}], "0"},
     {"0", 
      SqrtBox["x"], 
      SqrtBox[
       RowBox[{"1", "-", "x"}]], "0"},
     {
      SqrtBox["x"], "0", "0", 
      SqrtBox[
       RowBox[{"1", "-", "x"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9549210412505207`*^9, 3.954922727357733*^9, 
  3.954929954584083*^9, 3.954932290708418*^9, 3.957342334367898*^9, 
  3.957346688095044*^9, 3.9573606060006237`*^9},
 CellLabel->
  "Out[14]//MatrixForm=",ExpressionUUID->"eb2e2ed7-0903-4e3b-baf1-\
217a4be49374"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rhoxf", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], "[", 
    RowBox[{"rhoxf", ",", 
     RowBox[{"{", "2", "}"}], ",", "2"}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], "[", 
    RowBox[{"rhoxf", ",", 
     RowBox[{"{", "1", "}"}], ",", "2"}], "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9549209376422462`*^9, 3.954920963858445*^9}, {
   3.954920994162259*^9, 3.9549209943316507`*^9}, {3.954921347296569*^9, 
   3.954921350051688*^9}, {3.954921382881607*^9, 3.954921383701702*^9}, {
   3.95492147346987*^9, 3.954921474300859*^9}, 3.954921509318316*^9, {
   3.954922226300529*^9, 3.954922237784279*^9}, 3.9549223195879*^9, {
   3.9549223522051086`*^9, 3.954922352941992*^9}, {3.9549224056252327`*^9, 
   3.95492240660527*^9}, {3.954922592791316*^9, 3.9549225958002768`*^9}, {
   3.954922626610491*^9, 3.954922669386504*^9}, {3.9549322157659197`*^9, 
   3.954932223478519*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"02a66432-65f9-4ff9-82fc-283e03a99187"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", "x"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ")"}]}]], 
         " ", 
         RowBox[{"(", 
          RowBox[{"w", "+", "z"}], ")"}]}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"ba", " ", "ea"}]]}]], "0"},
     {"0", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"ba", " ", "ea"}]]}]], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ")"}]}]], 
        " ", 
        RowBox[{"(", 
         RowBox[{"w", "+", "z"}], ")"}]}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9549209658897057`*^9, 3.9549209960877943`*^9}, 
   3.954921048374277*^9, 3.954921350661913*^9, 3.9549214748774347`*^9, 
   3.954921510317095*^9, 3.9549222383340263`*^9, 3.9549223213037443`*^9, 
   3.954922353348968*^9, {3.9549224012697277`*^9, 3.954922407373995*^9}, 
   3.954922596817318*^9, {3.954922632015164*^9, 3.954922671020687*^9}, 
   3.9549322246604853`*^9, 3.957342338636031*^9},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"a5cca258-e676-4336-b452-\
e88a6c5bed4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "x"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ")"}]}]], 
         " ", 
         RowBox[{"(", 
          RowBox[{"w", "-", "z"}], ")"}]}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"bb", " ", "eb"}]]}]], "0"},
     {"0", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x"}], ")"}]}]], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "w"}], "+", "z"}], ")"}]}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9549209658897057`*^9, 3.9549209960877943`*^9}, 
   3.954921048374277*^9, 3.954921350661913*^9, 3.9549214748774347`*^9, 
   3.954921510317095*^9, 3.9549222383340263`*^9, 3.9549223213037443`*^9, 
   3.954922353348968*^9, {3.9549224012697277`*^9, 3.954922407373995*^9}, 
   3.954922596817318*^9, {3.954922632015164*^9, 3.954922671020687*^9}, 
   3.9549322246604853`*^9, 3.957342339143791*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"dbefca97-0737-455e-88cf-\
8fc7e3de54b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sigmax", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XX", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"sigmax", ",", "sigmax"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evolxx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], "*", "J", "*", "t", "*", 
      RowBox[{"XX", "/", "2"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhox", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "I"}], "*", "z"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "b", ",", 
        RowBox[{
         RowBox[{"-", "I"}], "*", "w"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"I", "*", "w"}], ",", "c", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I", "*", "z"}], ",", "0", ",", "0", ",", "d"}], "}"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoxf", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"evolxx", ".", "rhox", ".", 
      RowBox[{"ConjugateTranspose", "[", "evolxx", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", ">=", "0"}], " ", "&&", 
       RowBox[{"J", ">=", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wx", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{"Hab", ".", 
      RowBox[{"(", 
       RowBox[{"rhox", "-", "rhoxf"}], ")"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.954241736407303*^9, 3.95424186192724*^9}, 
   3.954242176076683*^9, {3.954242233212825*^9, 3.954242240798811*^9}, {
   3.954243233944927*^9, 3.954243247080901*^9}, 3.9549323007136383`*^9, {
   3.956317239553075*^9, 3.9563172419491*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3150f146-ce7f-4eee-bab2-e298af040e00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   FractionBox[
    RowBox[{"J", " ", "t"}], "2"], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"eb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "w"}], "+", "z"}], ")"}]}], "+", 
       RowBox[{"ea", " ", 
        RowBox[{"(", 
         RowBox[{"w", "+", "z"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"J", " ", "t"}], "2"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"J", " ", "t"}], "2"], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ea", " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "+", 
       RowBox[{"eb", " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.954241844365837*^9, 3.954241864405064*^9}, 
   3.954242150751217*^9, 3.954243252813047*^9, 3.954920518227807*^9, 
   3.95493230751653*^9, {3.956142417288767*^9, 3.9561424175491867`*^9}, 
   3.9561482054180613`*^9, 3.956924526705196*^9, 3.957258854242404*^9, 
   3.9573423468190527`*^9, 3.957346696170373*^9, 3.9573608790730467`*^9, 
   3.9576121831255913`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"1cd378fa-a940-40a2-969a-5070c29470e0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Montagem", " ", "de", " ", "Circuito", " ", "de", " ", "N"}], "=", 
   RowBox[{
    RowBox[{"4", " ", "x"}], "-", "state"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.955522978937327*^9, 3.9555229869551373`*^9}, {
  3.955523136036015*^9, 
  3.9555231374213467`*^9}},ExpressionUUID->"5f096d36-702e-44eb-b621-\
8e3d8d4f1e99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RxA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"theta1", "/", "2"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"theta1", "/", "2"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"theta1", "/", "2"}], "]"}]}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"theta1", "/", "2"}], "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"RxB", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"theta2", "/", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"-", "I"}], 
         RowBox[{"Sin", "[", 
          RowBox[{"theta2", "/", "2"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], 
         RowBox[{"Sin", "[", 
          RowBox[{"theta2", "/", "2"}], "]"}]}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta2", "/", "2"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "CNOTS", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"cnot01", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"cnot10", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"cnot001", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cnot100", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cnot0001", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cnot1000", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", "\n", "     ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", "\n", "     ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "1"}], "}"}], ",", " ", "\n", "     ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "1", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "1", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", "\n", "     ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "1", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}], ",", " ", "\n", "     ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "1", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", "0", 
       ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.955523168073483*^9, 3.955523185302322*^9}, {
  3.955523434516191*^9, 3.9555234728182898`*^9}, {3.95552353410955*^9, 
  3.9555237356458807`*^9}, {3.955523782054041*^9, 3.955523894918456*^9}, {
  3.955523936389057*^9, 3.9555239473966227`*^9}, {3.957258857174889*^9, 
  3.957258858434115*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"0957576e-327d-40c4-b8ab-b7e706dfe282"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Correlation", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ry1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "\[Phi]"}], ")"}], "/", "2"}], "]"}], 
         ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Theta]", "+", "\[Phi]"}], ")"}], "/", "2"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "\[Phi]"}], ")"}], "/", "2"}], "]"}], 
         ",", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "+", "\[Phi]"}], ")"}], "/", "2"}], "]"}]}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry11", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"ry1", ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Phi]"}], ")"}], "/", "2"}], "]"}], 
         ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Theta]", "-", "\[Phi]"}], ")"}], "/", "2"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Phi]"}], ")"}], "/", "2"}], "]"}], 
         ",", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Phi]"}], ")"}], "/", "2"}], "]"}]}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"ry2", ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rz1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"phi1", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"phi1", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rz2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"phi2", "/", "2"}]}], "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", 
           RowBox[{"phi2", "/", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzz", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"rz1", ",", "rz2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.955523176444577*^9, 3.955523182960704*^9}, 
   3.955544090051312*^9, {3.955629407247363*^9, 3.955629407907345*^9}, {
   3.95562953080275*^9, 3.955629531576172*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"2f35fead-9074-4c91-ace4-a3918f614bd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Work", " ", "step"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sigmax", "=", 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XX", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"sigmax", ",", "sigmax"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"evolxx", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "J", "*", "t", "*", 
        RowBox[{"XX", "/", "2"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9555239523533173`*^9, 3.955523963059394*^9}, {
  3.9555239950958033`*^9, 3.955524004208734*^9}, {3.955795301700131*^9, 
  3.9557953040920057`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"b7fa9fc1-4c01-4ec7-89e8-5af3e9835cdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"N", "=", "4"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Thermalization", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fund", "=", 
     RowBox[{"{", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", "->", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", "^", "6"}], "}"}]}], "]"}], "]"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fund", "=", 
     RowBox[{"Transpose", "[", "fund", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"fund", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bath", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"RxA", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}], ",", "RxB"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"cnot01", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot10"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"cnot001", ",", "cnot100"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thermastate", "=", 
     RowBox[{"cnot2", ".", "cnot1", ".", "bath", ".", "fund"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9555240234078703`*^9, 3.955524026967444*^9}, {
  3.955524207537142*^9, 3.955524249770685*^9}, {3.9555242956253138`*^9, 
  3.955524500275963*^9}, {3.955524614905368*^9, 3.9555246335543203`*^9}, {
  3.955524685840303*^9, 3.955524690636437*^9}, {3.9555247225282383`*^9, 
  3.955524778942588*^9}, {3.955524840067315*^9, 3.955524848174865*^9}, {
  3.9555248830170097`*^9, 3.955524933187873*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"7450f421-9413-41de-9f34-c95f69ea311f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "correlation", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ry11u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "ry11", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot01", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "ry22", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot10", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzzu", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "rz1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{
     "rzzu", ".", "cnot01u1", ".", "ry22u1", ".", "cnot10u1", ".", 
      "ry11u1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry11u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "ry1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "cnot0001", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "ry2", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "cnot1000", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzzv", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "rz1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{
     "rzzv", ".", "cnot01u2", ".", "ry22u2", ".", "cnot10u2", ".", 
      "ry11u2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statecorr1", "=", 
     RowBox[{"u2", ".", "u1", ".", "thermastate"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statecorr2", "=", 
     RowBox[{"u1", ".", "thermastate"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.955543900925016*^9, 3.955543912083107*^9}, {
   3.955543992608567*^9, 3.955543995157014*^9}, {3.955544035196059*^9, 
   3.955544085211487*^9}, {3.9555442214850597`*^9, 3.955544513615035*^9}, {
   3.9555446244624662`*^9, 3.9555446383313704`*^9}, 3.955544710556272*^9, 
   3.9555447570010443`*^9, {3.955546702639723*^9, 3.955546721411003*^9}, {
   3.955629572807993*^9, 3.955629691909844*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"40109fb2-b360-4c89-92d4-c43edf066d12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "extration", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"evolxxu", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "evolxx", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"finalstate", "=", 
     RowBox[{"evolxxu", ".", "statecorr2"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.955544801968646*^9, 3.9555448122499723`*^9}, 
   3.955546848655287*^9, {3.9555471804988537`*^9, 3.955547248826219*^9}, {
   3.9555473494444103`*^9, 3.955547349810961*^9}, {3.955629891140914*^9, 
   3.955629891405633*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"06019212-9a75-4a18-83af-223e3cdb1ca5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "condition", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"theta1", "=", 
     RowBox[{"2", "*", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"ea", "*", "ba"}], "]"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"theta2", "=", 
     RowBox[{"2", "*", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"eb", "*", "bb"}], "]"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Za", "=", 
     RowBox[{"Tr", "[", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "ba"}], "*", "ea", "*", 
        RowBox[{
         RowBox[{"PauliMatrix", "[", "3", "]"}], "/", "2"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zb", "=", 
     RowBox[{"Tr", "[", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "bb"}], "*", "eb", "*", 
        RowBox[{
         RowBox[{"PauliMatrix", "[", "3", "]"}], "/", "2"}]}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "ea"}], "*", "ba"}], "-", 
          RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "ea"}], "*", "ba"}], "+", 
          RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ea", "*", "ba"}], "-", 
          RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ea", "*", "ba"}], "+", 
          RowBox[{"eb", "*", "bb"}]}], ")"}], "/", "2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"Za", "*", "Zb"}], ")"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"a", "-", "c", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "-", "c"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[Alpha]", "2"]}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "-", "c"}], ")"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      FractionBox[
       RowBox[{"b", "-", "d", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"b", "-", "d"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[Alpha]", "2"]}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "d"}], ")"}]}]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"2", "*", 
      RowBox[{"\[Alpha]", "/", 
       RowBox[{"(", 
        RowBox[{"a", "-", "c"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"2", "*", 
      RowBox[{"\[Alpha]", "/", 
       RowBox[{"(", 
        RowBox[{"b", "-", "d"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Pi", "/", "4"}], "\[IndentingNewLine]", "\[Theta]"}], "=", 
      "\[Phi]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "=", 
     RowBox[{
      RowBox[{"ArcSin", "[", "x", "]"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", "=", 
     RowBox[{
      RowBox[{"ArcSin", "[", "y", "]"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Clear", "[", 
     RowBox[{"theta1", ",", "theta2"}], "]"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Clear", "[", "\[Alpha]", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.955544814904696*^9, 3.955544899861639*^9}, {
  3.955546157211566*^9, 3.9555461765401297`*^9}, {3.9555465567779617`*^9, 
  3.955546564669941*^9}, {3.955800320915655*^9, 3.9558003766906357`*^9}, {
  3.956142871092952*^9, 3.9561429491300373`*^9}, {3.9561430511786957`*^9, 
  3.956143052249844*^9}, {3.9561432176370287`*^9, 3.95614323513372*^9}, {
  3.956924671465639*^9, 3.956924706062704*^9}, {3.9573414122095127`*^9, 
  3.9573414174673853`*^9}, {3.9573415072559032`*^9, 3.957341529847488*^9}, {
  3.957341561602848*^9, 3.957341633718453*^9}, {3.957341757460802*^9, 
  3.957341806386142*^9}, {3.957341915388536*^9, 3.957341917395358*^9}, {
  3.957346759580288*^9, 3.957346764296274*^9}, {3.9573468389910603`*^9, 
  3.95734686166964*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"28dd0b1d-39a4-4670-a5be-66a3483c003f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rhother", "=", 
     RowBox[{"thermastate", ".", 
      RowBox[{"ConjugateTranspose", "[", "thermastate", "]"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rhocorr", "=", 
     RowBox[{"statecorr2", ".", 
      RowBox[{"ConjugateTranspose", "[", "statecorr2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expr1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"ba", "*", "ea"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"bb", "*", "eb"}], "]"}]}], ")"}], "*", "\[Alpha]"}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], " ", "+", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"ba", "*", "ea"}], "]"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Expr2", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "*", "\[Alpha]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"ba", "*", "ea"}], ")"}]}], " ", "+", " ", "1"}], ")"}], 
        "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"bb", "*", "eb"}], ")"}]}], " ", "+", " ", "1"}], ")"}]}],
        ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"bb", "*", "eb"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"ba", "*", "ea"}], ")"}]}], " ", "-", " ", "1"}], ")"}]}],
        ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi1", "=", 
     RowBox[{"Pi", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhow", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
        "[", 
        RowBox[{"rhocorr", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}], ",", "2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], "&&", 
         RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
         RowBox[{"bb", ">", "0"}], "&&", 
         RowBox[{"eb", ">", "0"}], " ", "&&", 
         RowBox[{"ea", ">", "0"}], "&&", 
         RowBox[{"ba", ">", "0"}]}], "  ", "}"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "<=", 
           RowBox[{"ArcSin", "[", "Expr1", "]"}], "<=", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "<=", 
           RowBox[{"ArcSin", "[", "Expr2", "]"}], "<=", "1"}]}], ")"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhot", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
        "[", 
        RowBox[{"rhocorr", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "4", ",", "6"}], "}"}], ",", "2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", ">", "0"}], "&&", 
         RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
         RowBox[{"bb", ">", "0"}], "&&", 
         RowBox[{"eb", ">", "0"}], " ", "&&", 
         RowBox[{"ea", ">", "0"}], "&&", 
         RowBox[{"ba", ">", "0"}]}], " ", "}"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "<=", 
           RowBox[{"ArcSin", "[", "Expr1", "]"}], "<=", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "<=", 
           RowBox[{"ArcSin", "[", "Expr2", "]"}], "<=", "1"}]}], ")"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.955524638342503*^9, 3.955524656982753*^9}, {
   3.955524733247439*^9, 3.955524744245871*^9}, {3.9555249120730762`*^9, 
   3.955525017773861*^9}, {3.955538119997859*^9, 3.955538120821456*^9}, {
   3.955544518704816*^9, 3.955544579101123*^9}, {3.955544661173896*^9, 
   3.955544692292392*^9}, {3.955544763809922*^9, 3.955544783543571*^9}, {
   3.955544935255927*^9, 3.955545019365408*^9}, {3.9555462051658907`*^9, 
   3.9555462217854652`*^9}, {3.9555462579968863`*^9, 3.955546276312677*^9}, {
   3.955546326781826*^9, 3.9555463279762506`*^9}, {3.955546587285342*^9, 
   3.9555466552411013`*^9}, {3.9555466893167353`*^9, 3.95554669126192*^9}, {
   3.955546731827355*^9, 3.955546746344624*^9}, {3.955629750793932*^9, 
   3.955629768366539*^9}, {3.957347578353801*^9, 3.9573476054016953`*^9}, {
   3.957347704455638*^9, 3.957347706110564*^9}, {3.957347808604*^9, 
   3.957347811499254*^9}, {3.957353598702632*^9, 3.957353611852047*^9}, {
   3.957353832510912*^9, 3.957353834100058*^9}, {3.957612560301519*^9, 
   3.9576125913781157`*^9}, {3.957612958140052*^9, 3.957612982826295*^9}, {
   3.9592617428101997`*^9, 3.959261770983838*^9}, 3.959261821166568*^9, {
   3.959262237339017*^9, 3.9592622706503763`*^9}, {3.9592623038817987`*^9, 
   3.9592623337677937`*^9}, {3.9592625397580767`*^9, 3.959262556532609*^9}, {
   3.959263806612361*^9, 3.959263820009256*^9}, {3.9592638642072067`*^9, 
   3.9592638714804983`*^9}, {3.959263977481821*^9, 3.959264023761269*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"53825147-609c-479a-a653-1737cca7207d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"rhow", ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "<=", 
        RowBox[{"ArcSin", "[", "Expr1", "]"}], "<=", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"-", "1"}], "<=", 
        RowBox[{"ArcSin", "[", "Expr2", "]"}], "<=", "1"}]}], ")"}]}]}], 
   "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9592639259953337`*^9, 3.959263952328454*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"56c49ea8-a243-4aaf-bfbb-6d2e781b6d12"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"Cosh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"bb", " ", "eb"}]]}], ")"}], "2"], " ", 
            SuperscriptBox["\[Alpha]", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Coth", "[", 
              FractionBox[
               RowBox[{"ba", " ", "ea"}], "2"], "]"}], "2"]}]}]]}], "+", 
        RowBox[{"Sinh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}]},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "bb", " ", "eb"}]], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"bb", " ", "eb"}]]}], ")"}], "2"], " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Coth", "[", 
               FractionBox[
                RowBox[{"ba", " ", "ea"}], "2"], "]"}], "2"]}]}]], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}], "0"},
     {"0", 
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "bb", " ", "eb"}]], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"bb", " ", "eb"}]]}], ")"}], "2"], " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Coth", "[", 
               FractionBox[
                RowBox[{"ba", " ", "ea"}], "2"], "]"}], "2"]}]}]], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {
      RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "0", "0", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"Cosh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"bb", " ", "eb"}]]}], ")"}], "2"], " ", 
            SuperscriptBox["\[Alpha]", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Coth", "[", 
              FractionBox[
               RowBox[{"ba", " ", "ea"}], "2"], "]"}], "2"]}]}]]}], "+", 
        RowBox[{"Sinh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9592639467228403`*^9, 3.959263953450222*^9}, 
   3.959264114208838*^9},
 CellLabel->
  "Out[134]//MatrixForm=",ExpressionUUID->"8107dafe-63b7-47da-a60a-\
0dc42e6a1576"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.959257988971257*^9, 3.959258045636568*^9}, {
   3.959261218410125*^9, 3.959261218944875*^9}, {3.959261523281177*^9, 
   3.959261568679057*^9}, 
   3.959261736151387*^9},ExpressionUUID->"ccdb8778-b264-480d-a3f6-\
7303070e69a1"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]"}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"ba", " ", "ea"}]]}]]], "Output",
 CellChangeTimes->{3.95926157514501*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"465b488e-cf6e-46b3-be4a-0bcec6b42f69"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "bb"}], " ", "eb"}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]"}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"ba", " ", "ea"}]]}]]], "Output",
 CellChangeTimes->{3.959261575160494*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"fffde1f1-a4a6-4b02-8530-677985ecfb77"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhof", "=", 
   RowBox[{"finalstate", ".", 
    RowBox[{"ConjugateTranspose", "[", "finalstate", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhowf", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
      "[", 
      RowBox[{"rhof", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}], ",", "2"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]", ">", "0"}], "&&", 
       RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
       RowBox[{"bb", ">", "0"}], "&&", 
       RowBox[{"eb", ">", "0"}], " ", "&&", 
       RowBox[{"ea", ">", "0"}], "&&", 
       RowBox[{"ba", ">", "0"}], "&&", 
       RowBox[{"J", ">", "0"}], "&&", 
       RowBox[{"t", ">", "0"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhotf", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
      "[", 
      RowBox[{"rhof", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "4", ",", "6"}], "}"}], ",", "2"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]", ">", "0"}], "&&", 
       RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
       RowBox[{"bb", ">", "0"}], "&&", 
       RowBox[{"eb", ">", "0"}], " ", "&&", 
       RowBox[{"ea", ">", "0"}], "&&", 
       RowBox[{"ba", ">", "0"}], "&&", 
       RowBox[{"J", ">", "0"}], "&&", 
       RowBox[{"t", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.955524795335135*^9, 3.9555248346581297`*^9}, {
  3.955547260688558*^9, 3.955547321681224*^9}, {3.955629967751492*^9, 
  3.955629976878261*^9}, {3.955796332560467*^9, 3.955796339408907*^9}, {
  3.955796507517007*^9, 3.955796508652141*^9}, {3.956143381898823*^9, 
  3.956143383068676*^9}, {3.959264307521294*^9, 3.9592643099968357`*^9}, {
  3.959264572555785*^9, 3.9592646164158087`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"6c878dad-0de7-485b-bca1-4f567d01bd28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"rhowf", ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "<=", 
        RowBox[{"ArcSin", "[", "Expr1", "]"}], "<=", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"-", "1"}], "<=", 
        RowBox[{"ArcSin", "[", "Expr2", "]"}], "<=", "1"}]}], ")"}]}]}], 
   "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{3.959264605901362*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"67c91592-df2a-4f18-a27d-77f6bced55f3"],

Cell[BoxData[
 TagBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       FractionBox[
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"ba", " ", "ea"}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"J", " ", "t"}], "+", 
            RowBox[{"ArcSin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
              RowBox[{"Coth", "[", 
               FractionBox[
                RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}]}]}], 
        
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0", "0", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"J", " ", "t"}], "+", 
          RowBox[{"ArcSin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
            RowBox[{"Coth", "[", 
             FractionBox[
              RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
      {"0", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], "+", 
            FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"3", "/", "4"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"bb", " ", "eb"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"J", " ", "t"}], "]"}], " ", 
             SqrtBox[
              RowBox[{"1", "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "bb", " ", "eb"}]], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"bb", " ", "eb"}]]}], ")"}], "2"], " ", 
                SuperscriptBox["\[Alpha]", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Coth", "[", 
                  FractionBox[
                   RowBox[{"ba", " ", "ea"}], "2"], "]"}], "2"]}]}]]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"bb", " ", "eb"}]], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
                
                RowBox[{"Sin", "[", 
                 RowBox[{"J", " ", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"J", " ", "t"}], "+", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "bb"}], " ", "eb"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
            RowBox[{"Coth", "[", 
             FractionBox[
              RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
      {"0", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"J", " ", "t"}], "+", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "bb"}], " ", "eb"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
            RowBox[{"Coth", "[", 
             FractionBox[
              RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"3", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"J", " ", "t"}], "+", 
              RowBox[{"ArcCos", "[", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{
                   RowBox[{"-", "bb"}], " ", "eb"}]], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]"}], 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"ba", " ", "ea"}]]}]], "]"}]}], "]"}]}]}], ")"}]}], 
        
        RowBox[{
         SqrtBox["2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"J", " ", "t"}], "+", 
          RowBox[{"ArcSin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
            RowBox[{"Coth", "[", 
             FractionBox[
              RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Tanh", "[", 
         FractionBox[
          RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0", "0", 
       FractionBox[
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"ba", " ", "ea"}]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"J", " ", "t"}], "+", 
            RowBox[{"ArcSin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"bb", " ", "eb"}]]}], ")"}], " ", "\[Alpha]", " ", 
              RowBox[{"Coth", "[", 
               FractionBox[
                RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], "]"}]}], "]"}]}]}], 
        
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9592646551526203`*^9},
 CellLabel->
  "Out[141]//MatrixForm=",ExpressionUUID->"609dc359-0e95-42ec-be13-\
649627fda310"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhof", "=", 
   RowBox[{"finalstate", ".", 
    RowBox[{"ConjugateTranspose", "[", "finalstate", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "}"}], ",", 
      "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "6"}], "}"}], ",", 
      "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.957259075810051*^9, 3.957259121872074*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"c549f27c-37b7-4dce-ae17-66b175bbc9d6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.957259111469899*^9, 3.957259122848731*^9}, 
   3.9572605004992113`*^9},
 CellLabel->
  "Out[78]//MatrixForm=",ExpressionUUID->"28e856f5-f129-4a22-9dc9-\
c25c57c2db5b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.957259111469899*^9, 3.957259122848731*^9}, 
   3.957260500514093*^9},
 CellLabel->
  "Out[79]//MatrixForm=",ExpressionUUID->"04d9bdd3-78a6-482d-8856-\
7a4526c70812"]
}, {1, 2, 3}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"N", "=", "8"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Thermalization", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fund", "=", 
     RowBox[{"{", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", "->", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", "^", "8"}], "}"}]}], "]"}], "]"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fund", "=", 
     RowBox[{"Transpose", "[", "fund", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"fund", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bath", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"RxA", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "6"}], "]"}], ",", "RxB"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"cnot01", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}], ",", "cnot10"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"cnot001", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot100"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot3", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"cnot0001", ",", "cnot1000"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thermastate", "=", 
     RowBox[{
     "cnot3", ".", "cnot2", ".", "cnot1", ".", "bath", ".", "fund"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.956738416791677*^9, 3.956738425828294*^9}, {
  3.95674319896318*^9, 3.956743224156704*^9}, {3.956743280873938*^9, 
  3.956743362992784*^9}, {3.956926434622158*^9, 3.956926435014937*^9}, {
  3.956928317587207*^9, 3.9569283195443897`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"cd31f323-f400-4f35-bf23-ccefb2326a09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "correlation", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ry11u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "ry11", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "cnot01", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "ry22", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10u1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "cnot10", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzzu", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "rz1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "4"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{
     "rzzu", ".", "cnot01u1", ".", "ry22u1", ".", "cnot10u1", ".", 
      "ry11u1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry11u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "ry1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "5"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot0001", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "ry2", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "5"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10u2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "cnot1000", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzzv", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "2"}], "]"}], ",", "rz1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "5"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{
     "rzzv", ".", "cnot01u2", ".", "ry22u2", ".", "cnot10u2", ".", 
      "ry11u2"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry11u3", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "ry1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "6"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot01u3", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "cnot000001", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ry22u3", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "ry2", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "6"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot10u3", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "cnot100000", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rzzz", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "1"}], "]"}], ",", "rz1", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "6"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u3", "=", 
     RowBox[{
     "rzzz", ".", "cnot01u3", ".", "ry22u3", ".", "cnot10u3", ".", 
      "ry11u3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statecorr1", "=", 
     RowBox[{"u3", ".", "u2", ".", "u1", ".", "thermastate"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statecorr2", "=", 
     RowBox[{"u2", ".", "u1", ".", "thermastate"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statecorr3", "=", 
     RowBox[{"u1", ".", "thermastate"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.956744897534954*^9, 3.9567449860470123`*^9}, {
  3.956745039050476*^9, 3.956745074648982*^9}, {3.956745128038927*^9, 
  3.956745129208499*^9}, {3.9567479961646633`*^9, 3.956748003515893*^9}, {
  3.95675918442531*^9, 3.956759191412861*^9}, {3.95683085308904*^9, 
  3.956830857790276*^9}, {3.9568308957833138`*^9, 3.956830903361443*^9}, {
  3.9569264625888157`*^9, 3.956926492800099*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"736d2a41-abfd-4823-bd81-2d22a18e9ebe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "extration", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"evolxxu", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}], ",", "evolxx", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"2", "^", "3"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"finalstate", "=", 
     RowBox[{"evolxxu", ".", "statecorr1"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.956928406665073*^9, 3.956928412506288*^9}, {
  3.957270064247076*^9, 3.957270070273335*^9}, {3.9572702345212383`*^9, 
  3.957270248477356*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"4e5c1fa2-6a29-4cff-b032-416a2955ce43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rhother", "=", 
     RowBox[{"thermastate", ".", 
      RowBox[{"ConjugateTranspose", "[", "thermastate", "]"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rhocorr", "=", 
     RowBox[{"statecorr1", ".", 
      RowBox[{"ConjugateTranspose", "[", "statecorr1", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
       "[", 
       RowBox[{"rhocorr", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7", ",", "8"}], 
         "}"}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", ">", "0"}], "&&", 
        RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
        RowBox[{"bb", ">", "0"}], "&&", 
        RowBox[{"eb", ">", "0"}], " ", "&&", 
        RowBox[{"ea", ">", "0"}], "&&", 
        RowBox[{"ba", ">", "0"}], "&&", " ", 
        RowBox[{"phi1", ">", "0"}]}], " ", "}"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
       "[", 
       RowBox[{"rhocorr", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "7", ",", "8"}], 
         "}"}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", ">", "0"}], "&&", 
        RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
        RowBox[{"bb", ">", "0"}], "&&", 
        RowBox[{"eb", ">", "0"}], " ", "&&", 
        RowBox[{"ea", ">", "0"}], "&&", 
        RowBox[{"ba", ">", "0"}], " ", "&&", " ", 
        RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
       "[", 
       RowBox[{"rhocorr", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "8"}], 
         "}"}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]", ">", "0"}], "&&", 
        RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
        RowBox[{"bb", ">", "0"}], "&&", 
        RowBox[{"eb", ">", "0"}], " ", "&&", 
        RowBox[{"ea", ">", "0"}], "&&", 
        RowBox[{"ba", ">", "0"}], "&&", " ", 
        RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.9569265684987707`*^9, 3.95692656889684*^9}, {
  3.956927101939986*^9, 3.956927227208789*^9}, {3.956927298567897*^9, 
  3.9569273002688637`*^9}, {3.956928360918817*^9, 3.9569283640001497`*^9}, {
  3.957270045871531*^9, 3.957270047203664*^9}, {3.957270546536439*^9, 
  3.957270678639765*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"de5a955b-6df1-4c3e-b994-6fc3fe612b7f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956927228528057*^9, 3.956927303645172*^9, 3.956928332402266*^9, 
   3.956928365385543*^9, 3.9572700742504787`*^9, 3.9572701809308863`*^9, {
   3.957270571047339*^9, 3.957270615008119*^9}, {3.957270653475038*^9, 
   3.9572706831252823`*^9}},
 CellLabel->
  "Out[214]//MatrixForm=",ExpressionUUID->"a7a63f05-5ac5-4a1f-bab8-\
e1b128ad6a8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956927228528057*^9, 3.956927303645172*^9, 3.956928332402266*^9, 
   3.956928365385543*^9, 3.9572700742504787`*^9, 3.9572701809308863`*^9, {
   3.957270571047339*^9, 3.957270615008119*^9}, {3.957270653475038*^9, 
   3.957270683217142*^9}},
 CellLabel->
  "Out[215]//MatrixForm=",ExpressionUUID->"bd4bde9e-706d-46e2-8972-\
5c978df030b4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956927228528057*^9, 3.956927303645172*^9, 3.956928332402266*^9, 
   3.956928365385543*^9, 3.9572700742504787`*^9, 3.9572701809308863`*^9, {
   3.957270571047339*^9, 3.957270615008119*^9}, {3.957270653475038*^9, 
   3.95727068331229*^9}},
 CellLabel->
  "Out[216]//MatrixForm=",ExpressionUUID->"2fdd28ba-f422-4501-9682-\
2c54b767de15"]
}, {1, 2, 3, 4}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhof", "=", 
   RowBox[{"finalstate", ".", 
    RowBox[{"ConjugateTranspose", "[", "finalstate", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}],
       ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}],
       ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}],
       ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.956928440355901*^9, 3.956928451079876*^9}, {
  3.956928631149694*^9, 3.956928681908592*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"64ca63ec-7952-4287-a834-b4e0626f1224"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956928454374381*^9, 3.956928683155644*^9, {3.95727023146975*^9, 
   3.957270256836543*^9}},
 CellLabel->
  "Out[175]//MatrixForm=",ExpressionUUID->"3eec9c24-e201-4ca1-ae63-\
be6665f802c5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"ba", " ", "ea"}]], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi1", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"J", " ", "t"}], "]"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"ba", " ", "ea"}], "2"]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "phi1", "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"J", " ", "t"}], "]"}], " ", 
            RowBox[{"Sin", "[", "phi1", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          FractionBox[
           RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}]},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"bb", " ", "eb"}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"J", " ", "t"}], "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "phi1", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Sin", "[", "phi1", "]"}]}]}], ")"}], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "phi1", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Sin", "[", "phi1", "]"}]}]}], ")"}], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"bb", " ", "eb"}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cosh", "[", 
           RowBox[{"ba", " ", "ea"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"J", " ", "t"}], "]"}]}], "+", 
          RowBox[{"Sinh", "[", 
           RowBox[{"ba", " ", "ea"}], "]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"ba", " ", "ea"}], "2"]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "phi1", "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"J", " ", "t"}], "]"}], " ", 
            RowBox[{"Sin", "[", "phi1", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sinh", "[", 
          FractionBox[
           RowBox[{"ba", " ", "ea"}], "2"], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"Cosh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi1", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"J", " ", "t"}], "]"}]}], "+", 
        RowBox[{"Sinh", "[", 
         RowBox[{"ba", " ", "ea"}], "]"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956928454374381*^9, 3.956928683155644*^9, {3.95727023146975*^9, 
   3.957270257249098*^9}},
 CellLabel->
  "Out[176]//MatrixForm=",ExpressionUUID->"1a55e637-101e-4935-b35f-\
340d1773b5dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]], "0", "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}]},
     {"0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
       RowBox[{"Tanh", "[", 
        FractionBox[
         RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Tanh", "[", 
          FractionBox[
           RowBox[{"bb", " ", "eb"}], "2"], "]"}]}], ")"}]}], 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "bb"}], " ", "eb"}]]}]}]], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "phi1"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"ba", " ", "ea"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"bb", " ", "eb"}]]}], ")"}]}]]}], "0", "0", 
      FractionBox["1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"bb", " ", "eb"}]]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.956928454374381*^9, 3.956928683155644*^9, {3.95727023146975*^9, 
   3.957270257349012*^9}},
 CellLabel->
  "Out[177]//MatrixForm=",ExpressionUUID->"22efa71c-d679-4dc8-8d61-\
269e18025a9d"]
}, {1, 2, 3, 4}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "5", ",", "6", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9572703186863527`*^9, 3.957270328122917*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"2e6b7990-306b-400c-8b64-18673ef3657f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9572703163951893`*^9, 3.9572703310372257`*^9}},
 CellLabel->
  "Out[179]//MatrixForm=",ExpressionUUID->"e25220ac-bb81-443b-be24-\
e739b2901db2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"Sin", "[", "phi1", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"J", " ", "t"}], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"ba", " ", "ea"}], "2"], "]"}], " ", 
          RowBox[{"Tanh", "[", 
           FractionBox[
            RowBox[{"bb", " ", "eb"}], "2"], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9572703163951893`*^9, 3.957270332865788*^9}},
 CellLabel->
  "Out[180]//MatrixForm=",ExpressionUUID->"c81ec7db-d86b-4813-972a-\
a33520c4eebc"]
}, {1, 2, 3}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MatrixPartialTrace\>\"", "]"}], 
     "[", 
     RowBox[{"rhof", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "8"}], 
       "}"}], ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "0"}], "&&", 
      RowBox[{"\[Phi]", ">", "0"}], " ", "&&", " ", 
      RowBox[{"bb", ">", "0"}], "&&", 
      RowBox[{"eb", ">", "0"}], " ", "&&", 
      RowBox[{"ea", ">", "0"}], "&&", 
      RowBox[{"ba", ">", "0"}], "&&", 
      RowBox[{"J", ">", "0"}], "&&", 
      RowBox[{"t", ">", "0"}], "&&", 
      RowBox[{"phi1", ">", "0"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.957270919811844*^9, 3.957271000730057*^9}, {
  3.9572719446001577`*^9, 3.957271972028594*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"3c0c3825-2cbb-4695-8c66-16b28c171bb4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.957270917840773*^9, {3.957270981386179*^9, 3.957271004904751*^9}, {
   3.957271961962625*^9, 3.957271973213314*^9}},
 CellLabel->
  "Out[232]//MatrixForm=",ExpressionUUID->"da85a9ed-a357-4f0b-950f-\
2140d0eb94fc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.957270917840773*^9, {3.957270981386179*^9, 3.957271004904751*^9}, {
   3.957271961962625*^9, 3.9572719732735233`*^9}},
 CellLabel->
  "Out[233]//MatrixForm=",ExpressionUUID->"d9a07e2e-8ae7-4c1d-a1cc-\
300857188142"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.957270917840773*^9, {3.957270981386179*^9, 3.957271004904751*^9}, {
   3.957271961962625*^9, 3.957271973373885*^9}},
 CellLabel->
  "Out[234]//MatrixForm=",ExpressionUUID->"efd787ef-fdef-4bd2-989b-\
7e2cf3721cd9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.957270917840773*^9, {3.957270981386179*^9, 3.957271004904751*^9}, {
   3.957271961962625*^9, 3.957271973479981*^9}},
 CellLabel->
  "Out[235]//MatrixForm=",ExpressionUUID->"8b6210d5-1d60-4625-a6cf-\
a5858007641f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.957270917840773*^9, {3.957270981386179*^9, 3.957271004904751*^9}, {
   3.957271961962625*^9, 3.957271973579831*^9}},
 CellLabel->
  "Out[236]//MatrixForm=",ExpressionUUID->"42740645-bd78-4feb-b8ec-\
1f5031e2fe16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "CNOT", "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.955523263858975*^9, 3.9555232695195723`*^9}, {
  3.956764942884994*^9, 
  3.956764948408794*^9}},ExpressionUUID->"41409f6c-2172-4a32-b6cb-\
2ddf847b77ba"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c1$$ = 5, $CellContext`c2$$ = 
    1, $CellContext`gate$$ = 1, $CellContext`n$$ = 5, $CellContext`t$$ = 
    1, $CellContext`viewQ$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`gate$$], 1, "gate"}, {1 -> "CNOT", 2 -> "Toffoli"}}, {
      Hold[
       Style["number of qubits"]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`n$$], 3, "n"}, 
      Dynamic[
       Range[1 + $CellContext`gate$$, 5]]}, {{
       Hold[$CellContext`c1$$], 1, "first control bit"}, 
      Dynamic[
       Range[$CellContext`n$$]]}, {{
       Hold[$CellContext`c2$$], 1, "second control bit"}, 
      Dynamic[
       Range[$CellContext`n$$]]}, {{
       Hold[$CellContext`t$$], 2, "target bit"}, 
      Dynamic[
       Range[$CellContext`n$$]]}, {{
       Hold[$CellContext`viewQ$$], 0, "view"}, {
      0 -> "array", 1 -> "matrix"}}}, Typeset`size$$ = {
    400., {231.7109375, 243.2890625}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`gate$33009$$ = False, $CellContext`viewQ$33010$$ = 
    False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`c1$$ = 1, $CellContext`c2$$ = 
        1, $CellContext`gate$$ = 1, $CellContext`n$$ = 3, $CellContext`t$$ = 
        2, $CellContext`viewQ$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`gate$$, $CellContext`gate$33009$$, False], 
        Hold[$CellContext`viewQ$$, $CellContext`viewQ$33010$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       If[$CellContext`n$$ < 1 + $CellContext`gate$$, $CellContext`n$$ = 
         1 + $CellContext`gate$$]; 
       If[$CellContext`c1$$ > $CellContext`n$$, $CellContext`c1$$ = \
$CellContext`n$$]; 
       If[$CellContext`c2$$ > $CellContext`n$$, $CellContext`c2$$ = \
$CellContext`n$$]; 
       If[$CellContext`t$$ > $CellContext`n$$, $CellContext`t$$ = \
$CellContext`n$$]; $CellContext`G[$CellContext`gate$$, $CellContext`n$$, \
$CellContext`c1$$, $CellContext`c2$$, $CellContext`t$$, \
$CellContext`viewQ$$]), 
      "Specifications" :> {{{$CellContext`gate$$, 1, "gate"}, {
         1 -> "CNOT", 2 -> "Toffoli"}, ControlType -> Setter}, Delimiter, 
        Style["number of qubits"], {{$CellContext`n$$, 3, "n"}, 
         Dynamic[
          Range[1 + $CellContext`gate$$, 5]], ControlType -> Setter}, 
        Delimiter, {{$CellContext`c1$$, 1, "first control bit"}, 
         Dynamic[
          Range[$CellContext`n$$]], ControlType -> Setter, ImageSize -> 
         Tiny}, {{$CellContext`c2$$, 1, "second control bit"}, 
         Dynamic[
          Range[$CellContext`n$$]], ControlType -> Setter, ImageSize -> Tiny, 
         Enabled -> Dynamic[$CellContext`gate$$ === 2]}, {{$CellContext`t$$, 
          2, "target bit"}, 
         Dynamic[
          Range[$CellContext`n$$]], ControlType -> Setter, ImageSize -> Tiny},
         Delimiter, {{$CellContext`viewQ$$, 0, "view"}, {
         0 -> "array", 1 -> "matrix"}}}, 
      "Options" :> {
       TrackedSymbols -> True, ControlPlacement -> Left, 
        AutorunSequencing -> {1, 6}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{606.72140625, {263.303125, 268.928125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`G[1, 
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`c2, 
          Blank[]], 
         Pattern[$CellContext`t, 
          Blank[]], 
         Pattern[$CellContext`viewQ, 
          Blank[]]] := Pane[
         If[$CellContext`viewQ == 1, 
          Style[
           Text[
            TraditionalForm[
             $CellContext`CNOT[$CellContext`n, $CellContext`c1, \
$CellContext`t]]], 
           Switch[$CellContext`n, 2, 24, 3, 20, 4, 18, 5, 10]], 
          ArrayPlot[
           $CellContext`CNOT[$CellContext`n, $CellContext`c1, $CellContext`t],
            ColorRules -> (1 -> Blue)]], ImageSize -> {400, 475}, 
         Alignment -> {Center, Center}, BaseStyle -> {
           Darker[Brown, 0.99], Background -> Lighter[Gray, 0.98], Bold, 
           26}], $CellContext`G[2, 
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`c2, 
          Blank[]], 
         Pattern[$CellContext`t, 
          Blank[]], 
         Pattern[$CellContext`viewQ, 
          Blank[]]] := Pane[
         If[$CellContext`viewQ == 1, 
          Style[
           Text[
            TraditionalForm[
             $CellContext`Toffoli[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t]]], 
           Switch[$CellContext`n, 3, 18, 4, 12, 5, 8]], 
          ArrayPlot[
           $CellContext`Toffoli[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t], ColorRules -> (1 -> Blue)]], 
         Alignment -> {Center, Center}, BaseStyle -> {
           Darker[Brown, 0.99], Background -> Lighter[Gray, 0.98], Bold, 26}, 
         ImageSize -> {400, 475}], $CellContext`CNOT[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`t, 
          Blank[]]] := (1/
         2) ($CellContext`TwoOp[$CellContext`n, $CellContext`c1, \
$CellContext`t, 0, 
           0] + $CellContext`TwoOp[$CellContext`n, $CellContext`c1, \
$CellContext`t, 3, 
           0] + $CellContext`TwoOp[$CellContext`n, $CellContext`c1, \
$CellContext`t, 0, 
           1] - $CellContext`TwoOp[$CellContext`n, $CellContext`c1, \
$CellContext`t, 3, 1]), $CellContext`TwoOp[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`c2, 
          Blank[]], 
         Pattern[$CellContext`op1, 
          Blank[]], 
         Pattern[$CellContext`op2, 
          Blank[]]] := $CellContext`SP[$CellContext`n, 
         ReplacePart[
          ReplacePart[
           $CellContext`ZeroT[$CellContext`n], $CellContext`op1, \
$CellContext`c1], $CellContext`op2, $CellContext`c2]], $CellContext`SP[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`Q, 
          Blank[]]] := If[$CellContext`n > 1, 
         KroneckerProduct[
          $CellContext`SP[$CellContext`n - 1, 
           Drop[$CellContext`Q, -1]], 
          PauliMatrix[
           Part[$CellContext`Q, $CellContext`n]]], 
         PauliMatrix[
          Part[$CellContext`Q, 1]]], $CellContext`ZeroT[
         Pattern[$CellContext`n, 
          Blank[]]] := Table[0, {$CellContext`n}], $CellContext`Toffoli[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`c2, 
          Blank[]], 
         Pattern[$CellContext`t, 
          Blank[]]] := (1/4) (
         3 $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 0, 0, 
            0] + $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 3, 0, 
           0] + $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 0, 3, 
           0] - $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 3, 3, 
          0] + $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 0, 0, 
           1] - $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 3, 0, 
          1] - $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 0, 3, 
          1] + $CellContext`ThreeOp[$CellContext`n, $CellContext`c1, \
$CellContext`c2, $CellContext`t, 3, 3, 1]), $CellContext`ThreeOp[
         Pattern[$CellContext`n, 
          Blank[]], 
         Pattern[$CellContext`c1, 
          Blank[]], 
         Pattern[$CellContext`c2, 
          Blank[]], 
         Pattern[$CellContext`c3, 
          Blank[]], 
         Pattern[$CellContext`op1, 
          Blank[]], 
         Pattern[$CellContext`op2, 
          Blank[]], 
         Pattern[$CellContext`op3, 
          Blank[]]] := $CellContext`SP[$CellContext`n, 
         ReplacePart[
          ReplacePart[
           ReplacePart[
            $CellContext`ZeroT[$CellContext`n], $CellContext`op1, \
$CellContext`c1], $CellContext`op2, $CellContext`c2], $CellContext`op3, \
$CellContext`c3]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",ExpressionUUID->"bb67fd82-\
70a7-4e01-af31-959618f99465"]
}, {1, 2}]],

Cell[CellGroupData[{

Cell[BoxData[
 NamespaceBox["WolframAlphaQueryParseResults",
  DynamicModuleBox[{Typeset`q$$ = "integrate x", Typeset`newq$$ = 
   "integrate x", Typeset`chosen$$ = "Integrate[x, x]", Typeset`open$$ = 
   False}, 
   PaneSelectorBox[{False->
    DynamicModuleBox[{Typeset`show$$ = False, Typeset`assumptionsQ$$ = False}, 
     TagBox[
      FrameBox[
       TagBox[GridBox[{
          {
           InputFieldBox[Dynamic[Typeset`newq$$], String,
            Appearance->None,
            BaseStyle->{"CalculateInput"},
            ContinuousAction->True,
            Enabled->True,
            FieldSize->{{1, 40}, {1, 
               DirectedInfinity[1]}},
            TrapSelection->False], 
           ItemBox[
            ButtonBox[
             PaneSelectorBox[{True->
              TagBox[
               TooltipBox[
                
                DynamicBox[FEPrivate`FrontEndResource[
                 "WABitmaps", "OrangeSquarePlus"],
                 ImageSizeCache->{11., {3.173828125, 7.826171875}}],
                DynamicBox[
                 ToBoxes[
                  FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"], 
                  StandardForm]]],
               Annotation[#, 
                Dynamic[
                 FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"]], 
                "Tooltip"]& ], False->
              TagBox[
               TooltipBox[
                
                DynamicBox[FEPrivate`FrontEndResource[
                 "WABitmaps", "GraySquarePlus"],
                 ImageSizeCache->{11., {3.173828125, 7.826171875}}],
                DynamicBox[
                 ToBoxes[
                  FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"], 
                  StandardForm]]],
               Annotation[#, 
                Dynamic[
                 FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"]], 
                "Tooltip"]& ]}, Dynamic[Typeset`show$$],
              ImageSize->All],
             Appearance->None,
             ButtonFunction:>(Quiet[
                WolframAlpha[]]; If[
                Or[
                 CurrentValue["OptionKey"], 
                 CurrentValue["AltKey"]], SelectionMove[
                  ButtonNotebook[], All, ButtonCell, AutoScroll -> False]; 
                NotebookWrite[
                  ButtonNotebook[], 
                  Cell[
                  Typeset`newq$$, "WolframAlphaShort", FormatType -> 
                   "TextForm"], All], Typeset`open$$ = True; 
                WolframAlphaClient`Private`extrudeFromFastParse["integrate x", 
                  Defer[
                   Integrate[$CellContext`x, $CellContext`x]], "Fast parse"]; 
                Typeset`open$$ = False]),
             Evaluator->Automatic,
             Method->"Queued"],
            Alignment->{Right, Top},
            StripOnInput->False]},
          {
           PaneBox[
            TagBox[
             TooltipBox[
              ButtonBox[
               PaneSelectorBox[{False->
                StyleBox[
                 RowBox[{"Integrate", "[", 
                  RowBox[{"x", ",", " ", "x"}], "]"}],
                 StripOnInput->False,
                 NumberMarks->False], True->
                StyleBox[
                 RowBox[{"Integrate", "[", 
                  RowBox[{"x", ",", " ", "x"}], "]"}],
                 StripOnInput->False,
                 ShowSyntaxStyles->False,
                 NumberMarks->False,
                 FontColor->RGBColor[1, 0.5, 0]]}, Dynamic[
                 CurrentValue["MouseOver"]],
                BaseStyle->{ShowStringCharacters -> True},
                FrameMargins->0,
                ImageSize->Automatic],
               Alignment->Left,
               Appearance->None,
               BaseStyle->{},
               ButtonFunction:>(SelectionMove[
                  ButtonNotebook[], All, ButtonCell]; NotebookWrite[
                  ButtonNotebook[], 
                  Cell[
                   BoxData[
                    RowBox[{"Integrate", "[", 
                    RowBox[{"x", ",", " ", "x"}], "]"}]], "Input"], All]; 
                SelectionMove[
                  ButtonNotebook[], After, CellContents]),
               Evaluator->Automatic,
               ImageSize->Automatic,
               Method->"Preemptive"],
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["WAStrings", "RemoveResults"], 
                StandardForm]]],
             Annotation[#, 
              Dynamic[
               FEPrivate`FrontEndResource["WAStrings", "RemoveResults"]], 
              "Tooltip"]& ],
            AppearanceElements->{},
            BaseStyle->{ShowStringCharacters -> True, ScriptLevel -> 0},
            ImageSize->{Automatic, {1, 100}},
            Scrollbars->{False, Automatic}], "\[SpanFromLeft]"}
         },
         AutoDelete->False,
         BaselinePosition->{1, 1},
         FrameStyle->GrayLevel[0.85],
         GridBoxAlignment->{"Columns" -> {{Left}}},
         GridBoxDividers->{
          "Columns" -> {{False}}, "Rows" -> {False, {True}, False}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
        "Grid"],
       Alignment->Top,
       Background->Dynamic[
         FEPrivate`If[
          FEPrivate`And[
           FEPrivate`SameQ[
            FEPrivate`Head[Typeset`newq$$], String], 
           FEPrivate`UnsameQ[Typeset`q$$, Typeset`newq$$]], 
          RGBColor[1., 0.975, 0.95], 
          GrayLevel[1]]],
       BaselinePosition->Baseline,
       FrameStyle->GrayLevel[0.85],
       ImageSize->Automatic,
       RoundingRadius->5,
       StripOnInput->False],
      EventHandlerTag[{
       "MouseEntered" :> FEPrivate`Set[Typeset`show$$, True], "MouseExited" :> 
        FEPrivate`Set[Typeset`show$$, False], Method -> "Preemptive", 
        PassEventsDown -> Automatic, PassEventsUp -> True}]],
     DynamicModuleValues:>{}], True->
    TagBox[GridBox[{
       {
        DynamicModuleBox[{Typeset`show$$ = False, Typeset`assumptionsQ$$ = 
         False}, 
         TagBox[
          FrameBox[
           TagBox[GridBox[{
              {
               InputFieldBox[Dynamic[Typeset`newq$$], String,
                Appearance->None,
                BaseStyle->{"CalculateInput"},
                ContinuousAction->True,
                Enabled->True,
                FieldSize->{{1, 40}, {1, 
                   DirectedInfinity[1]}},
                TrapSelection->False], 
               ItemBox[
                ButtonBox[
                 PaneSelectorBox[{True->
                  TagBox[
                   TooltipBox[
                    
                    DynamicBox[FEPrivate`FrontEndResource[
                    "WABitmaps", "OrangeSquarePlus"]],
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"],
                     StandardForm]]],
                   Annotation[#, 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "WAStrings", "ShowAllResults"]], "Tooltip"]& ], False->
                  TagBox[
                   TooltipBox[
                    
                    DynamicBox[FEPrivate`FrontEndResource[
                    "WABitmaps", "GraySquarePlus"]],
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource["WAStrings", "ShowAllResults"],
                     StandardForm]]],
                   Annotation[#, 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "WAStrings", "ShowAllResults"]], "Tooltip"]& ]}, Dynamic[
                  Typeset`show$$],
                  ImageSize->All],
                 Appearance->None,
                 ButtonFunction:>(Quiet[
                    WolframAlpha[]]; If[
                    Or[
                    CurrentValue["OptionKey"], 
                    CurrentValue["AltKey"]], SelectionMove[
                    ButtonNotebook[], All, ButtonCell, AutoScroll -> False]; 
                    NotebookWrite[
                    ButtonNotebook[], 
                    Cell[
                    Typeset`newq$$, "WolframAlphaShort", FormatType -> 
                    "TextForm"], All], Typeset`open$$ = True; 
                    WolframAlphaClient`Private`extrudeFromFastParse[
                    "integrate x", 
                    Defer[
                    Integrate[$CellContext`x, $CellContext`x]], "Fast parse"]; 
                    Typeset`open$$ = False]),
                 Evaluator->Automatic,
                 Method->"Queued"],
                Alignment->{Right, Top},
                StripOnInput->False]},
              {
               PaneBox[
                TagBox[
                 TooltipBox[
                  ButtonBox[
                   PaneSelectorBox[{False->
                    StyleBox[
                    RowBox[{"Integrate", "[", 
                    RowBox[{"x", ",", " ", "x"}], "]"}],
                    StripOnInput->False,
                    NumberMarks->False], True->
                    StyleBox[
                    RowBox[{"Integrate", "[", 
                    RowBox[{"x", ",", " ", "x"}], "]"}],
                    StripOnInput->False,
                    ShowSyntaxStyles->False,
                    NumberMarks->False,
                    FontColor->RGBColor[1, 0.5, 0]]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    BaseStyle->{ShowStringCharacters -> True},
                    FrameMargins->0,
                    ImageSize->Automatic],
                   Alignment->Left,
                   Appearance->None,
                   BaseStyle->{},
                   ButtonFunction:>(SelectionMove[
                    ButtonNotebook[], All, ButtonCell]; NotebookWrite[
                    ButtonNotebook[], 
                    Cell[
                    BoxData[
                    RowBox[{"Integrate", "[", 
                    RowBox[{"x", ",", " ", "x"}], "]"}]], "Input"], All]; 
                    SelectionMove[
                    ButtonNotebook[], After, CellContents]),
                   Evaluator->Automatic,
                   ImageSize->Automatic,
                   Method->"Preemptive"],
                  DynamicBox[
                   ToBoxes[
                    FEPrivate`FrontEndResource["WAStrings", "RemoveResults"], 
                    StandardForm]]],
                 Annotation[#, 
                  Dynamic[
                   FEPrivate`FrontEndResource["WAStrings", "RemoveResults"]], 
                  "Tooltip"]& ],
                AppearanceElements->{},
                BaseStyle->{ShowStringCharacters -> True, ScriptLevel -> 0},
                ImageSize->{Automatic, {1, 100}},
                Scrollbars->{False, Automatic}], "\[SpanFromLeft]"}
             },
             AutoDelete->False,
             BaselinePosition->{1, 1},
             FrameStyle->GrayLevel[0.85],
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxDividers->{
              "Columns" -> {{False}}, "Rows" -> {False, {True}, False}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Grid"],
           Alignment->Top,
           Background->Dynamic[
             FEPrivate`If[
              FEPrivate`And[
               FEPrivate`SameQ[
                FEPrivate`Head[Typeset`newq$$], String], 
               FEPrivate`UnsameQ[Typeset`q$$, Typeset`newq$$]], 
              RGBColor[1., 0.975, 0.95], 
              GrayLevel[1]]],
           BaselinePosition->Baseline,
           FrameStyle->GrayLevel[0.85],
           ImageSize->Automatic,
           RoundingRadius->5,
           StripOnInput->False],
          
          EventHandlerTag[{
           "MouseEntered" :> FEPrivate`Set[Typeset`show$$, True], 
            "MouseExited" :> FEPrivate`Set[Typeset`show$$, False], Method -> 
            "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
         DynamicModuleValues:>{}]},
       {
        InterpretationBox[
         StyleBox[
          
          DynamicBox[FEPrivate`FrontEndResource[
           "FEExpressions", "NecklaceAnimator"][20]],
          AnimatorBoxOptions->{ImageSize->20}],
         Animator[Appearance -> "Necklace", ImageSize -> 20],
         BaseStyle->{"Deploy"}]}
      },
      BaselinePosition->{1, 1},
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     
     "Column"]}, Dynamic[
     TrueQ[Typeset`open$$]],
    BaseStyle->{Deployed -> True},
    ImageSize->Automatic],
   DynamicModuleValues:>{}],
  BaseStyle->{Deployed -> True},
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True]], "WolframAlphaShortInput",
 CellLabel->"In[1]:=",ExpressionUUID->"b8355e56-8c85-450f-acec-a698242395e3"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["x", "2"], "2"]], "Output",
 CellChangeTimes->{3.956317259181923*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"bc5cf35e-c31b-4ba5-810c-d0e2f768fc13"]
}, {1, 2}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definindo", " ", "as", " ", "matrizes", " ", "b\[AAcute]sicas"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"I2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Matriz", " ", "Identidade", " ", "2", "x2"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Matriz", " ", "Pauli"}], "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"NOT", " ", "gate"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Projetor", "|", 
     RowBox[{"0", ">", "<", "0"}], "|"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Projetor", "|", 
     RowBox[{"1", ">", "<", "1"}], "|"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Construindo", " ", "a", " ", "matriz", " ", "CNOT", " ", "de", " ", "6", 
     " ", "qubits"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Controle", " ", "no", " ", "Qubit", " ", "1"}], ",", 
     RowBox[{"Target", " ", "no", " ", "Qubit", " ", "6"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Parte", " ", "1"}], ":", 
      RowBox[{"Controle", "|", 
       RowBox[{"0", ">", "<", "0"}], "|", 
       RowBox[{"no", " ", "Qubit", " ", "1"}]}]}], ",", 
     RowBox[{
      RowBox[{"Identidade", " ", "nos", " ", "Qubits", " ", "2"}], "-", "5"}],
      ",", 
     RowBox[{"Identidade", " ", "no", " ", "Qubit", " ", "6"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"P0", ",", "I2", ",", "I2", ",", "I2", ",", "I2", ",", "I2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Parte", " ", "2"}], ":", 
      RowBox[{"Controle", "|", 
       RowBox[{"1", ">", "<", "1"}], "|", 
       RowBox[{"no", " ", "Qubit", " ", "1"}]}]}], ",", 
     RowBox[{
      RowBox[{"Identidade", " ", "nos", " ", "Qubits", " ", "2"}], "-", "5"}],
      ",", 
     RowBox[{"X", " ", "no", " ", "Qubit", " ", "6"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"term2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"P1", ",", "I2", ",", "I2", ",", "I2", ",", "I2", ",", "X"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Matriz", " ", "CNOT", " ", "de", " ", "6", " ", "qubits"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"cnot000001", "=", 
     RowBox[{"term1", "+", "term2"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Para", " ", "visualizar", " ", "a", " ", "matriz", " ", 
     RowBox[{"(", 
      RowBox[{"ser\[AAcute]", " ", "uma", " ", "matriz", " ", "64", "x64"}], 
      ")"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.956745718881138*^9, 3.956745718881508*^9}, {
  3.956747965389377*^9, 3.956747971585024*^9}, {3.9567480258182917`*^9, 
  3.9567480261960793`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"adcf7434-8a6c-47d1-8f62-6b6231b44453"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Definindo", " ", "as", " ", "matrizes", " ", "b\[AAcute]sicas"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"I2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Matriz", " ", "Identidade", " ", "2", "x2"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Matriz", " ", "Pauli"}], "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"NOT", " ", "gate"}], ")"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Projetor", "|", 
     RowBox[{"0", ">", "<", "0"}], "|"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Projetor", "|", 
     RowBox[{"1", ">", "<", "1"}], "|"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Construindo", " ", "a", " ", "matriz", " ", "CNOT", " ", "de", " ", "6", 
     " ", "qubits"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Controle", " ", "no", " ", "Qubit", " ", "6"}], ",", 
     RowBox[{"Target", " ", "no", " ", "Qubit", " ", "1"}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Parte", " ", "1"}], ":", 
     RowBox[{"Controle", "|", 
      RowBox[{"0", ">", "<", "0"}], "|", 
      RowBox[{"no", " ", "Qubit", " ", "6"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "O", " ", "qubit", " ", "de", " ", "controle", " ", "P0", " ", 
     "est\[AAcute]", " ", "na", " ", "6", "\.aa", " ", 
     RowBox[{"posi\[CCedilla]\[ATilde]o", ".", "O"}], " ", "qubit", " ", 
     "alvo", " ", 
     RowBox[{"(", 
      RowBox[{"1", "\.ba"}], ")"}], " ", "e", " ", "os", " ", 
     "intermedi\[AAcute]rios", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "\.ba"}], "-", 
       RowBox[{"5", "\.ba"}]}], ")"}], " ", "s\[ATilde]o", " ", 
     RowBox[{"I2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term1", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"I2", ",", "I2", ",", "I2", ",", "I2", ",", "I2", ",", "P0"}], 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Parte", " ", "2"}], ":", 
     RowBox[{"Controle", "|", 
      RowBox[{"1", ">", "<", "1"}], "|", 
      RowBox[{"no", " ", "Qubit", " ", "6"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "O", " ", "qubit", " ", "de", " ", "controle", " ", "P1", " ", 
     "est\[AAcute]", " ", "na", " ", "6", "\.aa", " ", 
     RowBox[{"posi\[CCedilla]\[ATilde]o", ".", "O"}], " ", "qubit", " ", 
     "alvo", " ", 
     RowBox[{"(", 
      RowBox[{"1", "\.ba"}], ")"}], " ", "recebe", " ", 
     RowBox[{"X", ".", "Os"}], " ", "intermedi\[AAcute]rios", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "\.ba"}], "-", 
       RowBox[{"5", "\.ba"}]}], ")"}], " ", "s\[ATilde]o", " ", 
     RowBox[{"I2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term2", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"X", ",", "I2", ",", "I2", ",", "I2", ",", "I2", ",", "P1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Matriz", " ", "CNOT", " ", "de", " ", "6", " ", "qubits"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnot100000", "=", 
     RowBox[{"term1", "+", "term2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Para", " ", "visualizar", " ", "a", " ", "matriz", " ", 
     RowBox[{"(", 
      RowBox[{"ser\[AAcute]", " ", "uma", " ", "matriz", " ", "64", "x64"}], 
      ")"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.9567458178787413`*^9, 3.956745817878983*^9}, {
  3.956748013703486*^9, 3.956748022513237*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"bf7dede5-020e-4c4b-b0c2-aae219251777"]
},
WindowSize->{1387.5, 762},
WindowMargins->{{Automatic, -1200}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Dracula.nb",
ExpressionUUID->"32f823b5-84aa-4978-9d9c-b80f0650779f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 2560, 82, 325, "Input",ExpressionUUID->"33e77633-8c40-4fbd-8ff3-e06837bafe22"],
Cell[CellGroupData[{
Cell[3139, 106, 2724, 79, 211, "Input",ExpressionUUID->"bc73fb15-897c-4942-8634-0de2cc06af16"],
Cell[5866, 187, 1283, 35, 49, "Output",ExpressionUUID->"5b4dbbb2-5c7b-41c7-a707-372f1bb5d4ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7186, 227, 370, 6, 97, "Input",ExpressionUUID->"8c0a3435-cb5e-4149-9e79-da074c18cd9b"],
Cell[7559, 235, 2440, 71, 186, "Output",ExpressionUUID->"5750a5ff-7750-457d-bc44-1b716c12206e"],
Cell[10002, 308, 1122, 37, 106, "Output",ExpressionUUID->"eb2e2ed7-0903-4e3b-baf1-217a4be49374"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11161, 350, 1271, 25, 117, "Input",ExpressionUUID->"02a66432-65f9-4ff9-82fc-283e03a99187"],
Cell[12435, 377, 2444, 70, 98, "Output",ExpressionUUID->"a5cca258-e676-4336-b452-e88a6c5bed4f"],
Cell[14882, 449, 2470, 71, 98, "Output",ExpressionUUID->"dbefca97-0737-455e-88cf-8fc7e3de54b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17389, 525, 2135, 60, 290, "Input",ExpressionUUID->"3150f146-ce7f-4eee-bab2-e298af040e00"],
Cell[19527, 587, 1434, 41, 54, "Output",ExpressionUUID->"1cd378fa-a940-40a2-969a-5070c29470e0"]
}, Open  ]],
Cell[20976, 631, 376, 9, 60, "Input",ExpressionUUID->"5f096d36-702e-44eb-b621-8e3d8d4f1e99"],
Cell[21355, 642, 13771, 332, 498, "Input",ExpressionUUID->"0957576e-327d-40c4-b8ab-b7e706dfe282"],
Cell[35129, 976, 4589, 139, 387, "Input",ExpressionUUID->"2f35fead-9074-4c91-ace4-a3918f614bd2"],
Cell[39721, 1117, 922, 24, 176, "Input",ExpressionUUID->"b7fa9fc1-4c01-4ec7-89e8-5af3e9835cdc"],
Cell[40646, 1143, 2302, 62, 345, "Input",ExpressionUUID->"7450f421-9413-41de-9f34-c95f69ea311f"],
Cell[42951, 1207, 4351, 117, 496, "Input",ExpressionUUID->"40109fb2-b360-4c89-92d4-c43edf066d12"],
Cell[47305, 1326, 850, 20, 102, "Input",ExpressionUUID->"06019212-9a75-4a18-83af-223e3cdb1ca5"],
Cell[48158, 1348, 5586, 164, 680, "Input",ExpressionUUID->"28dd0b1d-39a4-4670-a5be-66a3483c003f"],
Cell[53747, 1514, 5703, 143, 444, "Input",ExpressionUUID->"53825147-609c-479a-a653-1737cca7207d"],
Cell[CellGroupData[{
Cell[59475, 1661, 594, 16, 62, "Input",ExpressionUUID->"56c49ea8-a243-4aaf-bfbb-6d2e781b6d12"],
Cell[60072, 1679, 5534, 156, 197, "Output",ExpressionUUID->"8107dafe-63b7-47da-a60a-0dc42e6a1576"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65643, 1840, 275, 5, 45, "Input",ExpressionUUID->"ccdb8778-b264-480d-a3f6-7303070e69a1"],
Cell[65921, 1847, 563, 16, 59, "Output",ExpressionUUID->"465b488e-cf6e-46b3-be4a-0bcec6b42f69"],
Cell[66487, 1865, 661, 19, 59, "Output",ExpressionUUID->"fffde1f1-a4a6-4b02-8530-677985ecfb77"]
}, Open  ]],
Cell[67163, 1887, 2149, 56, 139, "Input",ExpressionUUID->"6c878dad-0de7-485b-bca1-4f567d01bd28"],
Cell[CellGroupData[{
Cell[69337, 1947, 569, 16, 62, "Input",ExpressionUUID->"67c91592-df2a-4f18-a27d-77f6bced55f3"],
Cell[69909, 1965, 11341, 307, 248, "Output",ExpressionUUID->"609dc359-0e95-42ec-be13-649627fda310"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81287, 2277, 1849, 51, 213, "Input",ExpressionUUID->"c549f27c-37b7-4dce-ae17-66b175bbc9d6"],
Cell[83139, 2330, 1402, 42, 83, "Output",ExpressionUUID->"28e856f5-f129-4a22-9dc9-c25c57c2db5b"],
Cell[84544, 2374, 1628, 48, 83, "Output",ExpressionUUID->"04d9bdd3-78a6-482d-8856-7a4526c70812"]
}, {1, 2, 3}]],
Cell[86190, 2425, 2403, 69, 362, "Input",ExpressionUUID->"cd31f323-f400-4f35-bf23-ccefb2326a09"],
Cell[88596, 2496, 6282, 172, 742, "Input",ExpressionUUID->"736d2a41-abfd-4823-bd81-2d22a18e9ebe"],
Cell[94881, 2670, 776, 20, 102, "Input",ExpressionUUID->"4e5c1fa2-6a29-4cff-b032-416a2955ce43"],
Cell[CellGroupData[{
Cell[95682, 2694, 3065, 80, 253, "Input",ExpressionUUID->"de5a955b-6df1-4c3e-b994-6fc3fe612b7f"],
Cell[98750, 2776, 3637, 107, 174, "Output",ExpressionUUID->"a7a63f05-5ac5-4a1f-bab8-e1b128ad6a8d"],
Cell[102390, 2885, 3635, 107, 174, "Output",ExpressionUUID->"bd4bde9e-706d-46e2-8972-5c978df030b4"],
Cell[106028, 2994, 3634, 107, 174, "Output",ExpressionUUID->"2fdd28ba-f422-4501-9682-2c54b767de15"]
}, {1, 2, 3, 4}]],
Cell[CellGroupData[{
Cell[109705, 3106, 2702, 75, 290, "Input",ExpressionUUID->"64ca63ec-7952-4287-a834-b4e0626f1224"],
Cell[112410, 3183, 3488, 105, 174, "Output",ExpressionUUID->"3eec9c24-e201-4ca1-ae63-be6665f802c5"],
Cell[115901, 3290, 7309, 209, 230, "Output",ExpressionUUID->"1a55e637-101e-4935-b35f-340d1773b5dd"],
Cell[123213, 3501, 3488, 105, 174, "Output",ExpressionUUID->"22efa71c-d679-4dc8-8d61-269e18025a9d"]
}, {1, 2, 3, 4}]],
Cell[CellGroupData[{
Cell[126744, 3611, 1750, 49, 176, "Input",ExpressionUUID->"2e6b7990-306b-400c-8b64-18673ef3657f"],
Cell[128497, 3662, 1379, 41, 81, "Output",ExpressionUUID->"e25220ac-bb81-443b-be24-e739b2901db2"],
Cell[129879, 3705, 1605, 47, 81, "Output",ExpressionUUID->"c81ec7db-d86b-4813-972a-a33520c4eebc"]
}, {1, 2, 3}]],
Cell[CellGroupData[{
Cell[131524, 3757, 4196, 119, 405, "Input",ExpressionUUID->"3c0c3825-2cbb-4695-8c66-16b28c171bb4"],
Cell[135723, 3878, 770, 23, 72, "Output",ExpressionUUID->"da85a9ed-a357-4f0b-950f-2140d0eb94fc"],
Cell[136496, 3903, 772, 23, 72, "Output",ExpressionUUID->"d9a07e2e-8ae7-4c1d-a1cc-300857188142"],
Cell[137271, 3928, 770, 23, 72, "Output",ExpressionUUID->"efd787ef-fdef-4bd2-989b-7e2cf3721cd9"],
Cell[138044, 3953, 770, 23, 72, "Output",ExpressionUUID->"8b6210d5-1d60-4625-a6cf-a5858007641f"],
Cell[138817, 3978, 770, 23, 116, "Output",ExpressionUUID->"42740645-bd78-4feb-b8ec-1f5031e2fe16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139624, 4006, 267, 6, 65, "Input",ExpressionUUID->"41409f6c-2172-4a32-b6cb-2ddf847b77ba"],
Cell[139894, 4014, 9265, 216, 549, "Output",ExpressionUUID->"bb67fd82-70a7-4e01-af31-959618f99465"]
}, {1, 2}]],
Cell[CellGroupData[{
Cell[149196, 4235, 13043, 322, 80, "WolframAlphaShortInput",ExpressionUUID->"b8355e56-8c85-450f-acec-a698242395e3"],
Cell[162242, 4559, 192, 4, 48, "Output",ExpressionUUID->"bc5cf35e-c31b-4ba5-810c-d0e2f768fc13"]
}, {1, 2}]],
Cell[162449, 4566, 3900, 110, 430, "Input",ExpressionUUID->"adcf7434-8a6c-47d1-8f62-6b6231b44453"],
Cell[166352, 4678, 4642, 129, 505, "Input",ExpressionUUID->"bf7dede5-020e-4c4b-b0c2-aae219251777"]
}
]
*)

